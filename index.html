<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <meta name="color-scheme" content="dark">
  <meta name="theme-color" content="#1a1a1a">
  <title>Generator de Numere de Telefon</title>
  <!-- Link to your CSS -->
  <link rel="stylesheet" href="style.css">
  <!-- Include SheetJS (xlsx.full.min.js) from CDN for Excel processing -->
  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
</head>
<body>
  <h1>Generator de Numere de Telefon</h1>
  
  <div id="form-section">
    <div class="file-input-group">
      <label for="sourceFile">Numere Sursă (Excel):</label>
      <input type="file" id="sourceFile" accept=".xlsx,.xls" />
      <button class="template-btn" id="sourceTemplateBtn">Descarcă Template Sursă</button>
    </div>

    <div class="file-input-group">
      <label for="blacklistFile">Lista Neagră (Excel) [Opțional]:</label>
      <input type="file" id="blacklistFile" accept=".xlsx,.xls" />
      <button class="template-btn" id="blacklistTemplateBtn">Descarcă Template Blacklist</button>
    </div>

    <label for="variations">Variații per număr:</label>
    <input type="number" id="variations" min="1" value="5" />

    <label for="digitsToVary">Număr de cifre de variat (1-6):</label>
    <input type="number" id="digitsToVary" min="1" max="6" value="3" />

    <!-- Add operator filter -->
    <label for="operatorFilter">Filtru Operator:</label>
    <select id="operatorFilter" multiple>
      <option value="Orange">Orange</option>
      <option value="Moldcell">Moldcell</option>
      <option value="Unite">Unite</option>
      <option value="Moldtelecom">Moldtelecom</option>
    </select>

    <!-- Add fallback operator -->
    <label for="fallbackOperator">Operator implicit (fallback):</label>
    <select id="fallbackOperator">
      <option value="Orange">Orange</option>
      <option value="Moldcell">Moldcell</option>
      <option value="Unite">Unite</option>
      <option value="Moldtelecom">Moldtelecom</option>
    </select>

    <!-- Add format validation options -->
    <div class="checkbox-group">
      <label>
        <input type="checkbox" id="validateSequential" checked>
        Exclude numere secvențiale (ex: 123, 321)
      </label>
      <label>
        <input type="checkbox" id="validateRepeating" checked>
        Exclude cifre repetate (ex: 111, 222)
      </label>
    </div>

    <!-- Simplified summary section -->
    <div id="summary-section" class="hidden">
      <h3>Sumar General:</h3>
      <p>Total numere procesate: <span id="processedCount">0</span></p>
      <p>Total numere generate: <span id="generatedCount">0</span></p>
      <p>Total numere respinse: <span id="rejectedCount">0</span></p>

      <h3>Statistici pe Operatori:</h3>
      <div id="operatorStats">
        <div class="operator-stat">
          <h4>Orange</h4>
          <p>Originale: <span id="orangeOriginalCount">0</span></p>
          <p>Generate: <span id="orangeGeneratedCount">0</span></p>
        </div>
        <div class="operator-stat">
          <h4>Moldcell</h4>
          <p>Originale: <span id="moldcellOriginalCount">0</span></p>
          <p>Generate: <span id="moldcellGeneratedCount">0</span></p>
        </div>
        <div class="operator-stat">
          <h4>Unite</h4>
          <p>Originale: <span id="uniteOriginalCount">0</span></p>
          <p>Generate: <span id="uniteGeneratedCount">0</span></p>
        </div>
        <div class="operator-stat">
          <h4>Moldtelecom</h4>
          <p>Originale: <span id="moldtelecomOriginalCount">0</span></p>
          <p>Generate: <span id="moldtelecomGeneratedCount">0</span></p>
        </div>
      </div>
    </div>
  
    <button id="generateBtn">Generează</button>
    <div class="error" id="errorMsg"></div>
  </div>

  <div class="output hidden" id="output-section">
    <p>Generare completă! Click mai jos pentru descărcare:</p>
    <button id="downloadBtn">Descarcă Excel</button>
  </div>

  <!-- Link to your main JavaScript -->
  <script src="script.js"></script>
</body>
</html>
